<!DOCTYPE html>
  <html class="no-js" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Simulating Rabi oscillations with noise and decoherence &mdash; Qiskit Dynamics 0.4.3 documentation</title>
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="../_static/thebelab.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" /><script src="../_static/js/web-components/top-nav-bar.js"></script>

  <!-- SEGMENT ANALYTICS -->
    <script>
      (function () {
        window._analytics = {
          segment_key: 'ffdYLviQze3kzomaINXNk6NwpY9LlXcw',
          coremetrics: false,
          optimizely: false,
          googleAddServices: false,
          fullStory: false,
          autoPageEventSpa: false,
          autoFormEvents: false,
          autoPageView: false
        }

        window.digitalData = {
          page: {
            pageInfo: {
              productTitle: 'IBM Q Experience',
              analytics: {
                category: 'Qiskit.org'
              }
            }
          }
        }
      }());
    </script>
    <script src="https://cloud.ibm.com/analytics/build/bluemix-analytics.min.js"></script>
    <script>
      (function () {
        'use strict'

        if (!window.bluemixAnalytics || !window.digitalData) { return }

        const category = window.digitalData.page.pageInfo.analytics.category
        const productTitle = window.digitalData.page.pageInfo.productTitle
        const routeName = 'documentation'

        window.bluemixAnalytics.pageEvent(category, routeName, {
          navigationType: 'pushState',
          productTitle: productTitle,
          title: document.title
        })

        window.trackCta = (action) => {
          if (!window.bluemixAnalytics || !window.digitalData) { return }

          const category = window.digitalData.page.pageInfo.analytics.category
          const productTitle = window.digitalData.page.pageInfo.productTitle

          window.bluemixAnalytics.trackEvent('CTA Clicked', {
            productTitle,
            category,
            CTA: action
          })
        }

      }());
    </script></head>
<body class="pytorch-body">
  <!-- UNIFIED TOP MENU -->
  <qiskit-ui-shell variant="hide-account"></qiskit-ui-shell>

   

    <!-- LEFT SIDE BAR -->

    <!-- if translations available, display language dropdown menu -->
    

    <!-- Menu becomes dropdown in mobile view -->
    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <!-- left side bar main content -->
    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
    <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <div class="sidebar">
    <div class="pytorch-left-menu-search">
        <div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Qiskit Dynamics Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    </div>

    <!-- render sidebar from the toctree -->
    
    
        <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidocs/index.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../discussions/index.html">Discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>

    

    <!-- PREVIOUS RELEASES -->
        

    </div>
  </div>
</nav>

<!-- OPTIONAL EXPANDABLE FUNCTIONALITY -->


<!-- STYLING -->
<script>
    // indent subheadings under captions
    expandable_rows = document.getElementsByClassName("caption");
    var i;
    for (i = 0; i < expandable_rows.length; i++) {
        expandable_rows[i].nextElementSibling.style.marginLeft = "1rem"

        // un-bold subheadings in dropdown
        var subheadings = expandable_rows[i].nextElementSibling
        for (j = 0; j < subheadings.children.length; j++) {
            subheadings.children[j].style.fontWeight = "unset"
        }
    }

    // adjust toctree class name to style external links
    var toc_rows = document.getElementsByClassName("toctree-l1");
    var i;
    for (i = 0; i < toc_rows.length; i++) {
        if (toc_rows[i].children[0].className === "reference external") {
            toc_rows[i].className = "toctree-l1-external"
            }
    }

    // expand and unexpand previous releases dropdown when clicked
    var release_rows = document.getElementsByClassName("sidebar-l1-expandable");
    for (i = 0; i < release_rows.length; i++) {
        release_rows[i].addEventListener("click", function() {
            this.classList.toggle("open");
            var clicked_subheadings = this.nextElementSibling;
            if (clicked_subheadings.style.display === "block") {
            clicked_subheadings.style.display = "none";
            } else {
            clicked_subheadings.style.display = "block";
            }
        });
    }
</script>

    <div class="pytorch-container">

      <!-- BREADCRUMB MINI MENU BELOW TOP NAV BAR -->
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          <div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
            Qiskit Dynamics  documentation
        </a> &gt;
      </li>

        
          <li><a href="index.html">Dynamics Tutorials</a> &gt;</li>
        
      <li>Simulating Rabi oscillations with noise and decoherence</li>
    
  </ul>
</div>
        </div>
      </div>

      <!-- MAIN CENTRE CONTENT -->
      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        
        <div class="pytorch-content-left">
          <div class="rst-content">
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <section id="simulating-rabi-oscillations-with-noise-and-decoherence">
<h1>Simulating Rabi oscillations with noise and decoherence<a class="headerlink" href="#simulating-rabi-oscillations-with-noise-and-decoherence" title="Permalink to this heading">¶</a></h1>
<p>In this tutorial we walk through an example of solving using
<code class="docutils literal notranslate"><span class="pre">qiskit_dynamics</span></code> the time evolution of a qubit being driven close to
resonance. The model that we solve consists of a single qubit perturbed
by a sinusoidal drive. In addition, will consider energy relaxation and
decoherence terms modeled by using a Lindblad master equation.</p>
<p>In the sections below we define a model, solve the dynamics and plot the
qubit oscillations using the following steps:</p>
<ol class="arabic simple">
<li><p>Setup a <a class="reference internal" href="../stubs/qiskit_dynamics.solvers.Solver.html#qiskit_dynamics.solvers.Solver" title="qiskit_dynamics.solvers.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a> with the Hamiltonian model</p></li>
<li><p>Define the initial state and simulation times, and evolve the system state.</p></li>
<li><p>Plot the qubit state as a function of time and discuss the results.</p></li>
<li><p>Solve again the the model with jump operators for the Lindblad dissipator, and plot the results.</p></li>
</ol>
<p>In the first step below, we model the time evolution of a qubit’s state
taken as a two-level system, using the Schrödinger equation with a
Hamiltonian containing a diagonal term of frequency <span class="math notranslate nohighlight">\(\nu_z\)</span> and a
transverse term of amplitude <span class="math notranslate nohighlight">\(\nu_x\)</span> and harmonic driving
frequency <span class="math notranslate nohighlight">\(\nu_d\)</span> (see how the Hamiltonians are derived on
<a class="reference external" href="https://qiskit.org/textbook/ch-quantum-hardware/transmon-physics.html">Qiskit Textbook page on Introduction to Transmon Physics</a>),</p>
<div class="math notranslate nohighlight">
\[H = \frac{1}{2} \times 2 \pi \nu_z {Z} + 2 \pi \nu_x \cos(2 \pi \nu_d t){X},\]</div>
<p>where <span class="math notranslate nohighlight">\(\{X,Y,Z\}\)</span> are the Pauli matrices (also written as
<span class="math notranslate nohighlight">\(\sigma^a\)</span> with <span class="math notranslate nohighlight">\(a\in\{x,y,z\}\)</span>).</p>
<section id="setup-the-solver-with-the-hamiltonian-model">
<h2>1. Setup the solver with the Hamiltonian model<a class="headerlink" href="#setup-the-solver-with-the-hamiltonian-model" title="Permalink to this heading">¶</a></h2>
<p>In the following, we will set <span class="math notranslate nohighlight">\(\hbar=1\)</span> and fix some arbitrary
time units, with all frequency parameters scaled accordingly. Below, we
first set a few values for these frequency parameters, and then setup the
<a class="reference internal" href="../stubs/qiskit_dynamics.solvers.Solver.html#qiskit_dynamics.solvers.Solver" title="qiskit_dynamics.solvers.Solver"><code class="xref py py-class docutils literal notranslate"><span class="pre">Solver</span></code></a> class instance that stores and manipulates the model to be
solved, using matrices and <a class="reference internal" href="../stubs/qiskit_dynamics.signals.Signal.html#qiskit_dynamics.signals.Signal" title="qiskit_dynamics.signals.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> instances. For the
time-independent <span class="math notranslate nohighlight">\(z\)</span> term we set the signal to a constant, while
for the trasverse driving term we setup a harmonic signal.</p>
<div class="jupyter_cell docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">Operator</span>
<span class="kn">from</span> <span class="nn">qiskit_dynamics</span> <span class="kn">import</span> <span class="n">Solver</span><span class="p">,</span> <span class="n">Signal</span>


<span class="n">nu_z</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">nu_x</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">nu_d</span> <span class="o">=</span> <span class="mf">9.98</span>  <span class="c1"># Almost on resonance with the Hamiltonian&#39;s energy levels difference, nu_z</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">Operator</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Operator</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">Operator</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="n">s_p</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">solver</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span>
    <span class="n">static_hamiltonian</span><span class="o">=</span><span class="mf">.5</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">nu_z</span> <span class="o">*</span> <span class="n">Z</span><span class="p">,</span>
    <span class="n">hamiltonian_operators</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">nu_x</span> <span class="o">*</span> <span class="n">X</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="solve-the-system">
<h2>2. Solve the system<a class="headerlink" href="#solve-the-system" title="Permalink to this heading">¶</a></h2>
<p>We now define the initial state for the simulation, the time span to
simulate for, and the intermediate times for which the solution is
requested, and solve the evolution.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.quantum_info.states</span> <span class="kn">import</span> <span class="n">Statevector</span>
<span class="kn">from</span> <span class="nn">qiskit.quantum_info</span> <span class="kn">import</span> <span class="n">DensityMatrix</span>

<span class="n">t_final</span> <span class="o">=</span> <span class="mf">.5</span> <span class="o">/</span> <span class="n">nu_x</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">.005</span>

<span class="n">y0</span> <span class="o">=</span> <span class="n">Statevector</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>

<span class="n">n_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">t_final</span> <span class="o">/</span> <span class="n">tau</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">t_final</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>
<span class="n">signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">Signal</span><span class="p">(</span><span class="n">envelope</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">carrier_freq</span><span class="o">=</span><span class="n">nu_d</span><span class="p">)]</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">t_span</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">t_final</span><span class="p">],</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">signals</span><span class="o">=</span><span class="n">signals</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="plot-the-qubit-state">
<h2>3. Plot the qubit state<a class="headerlink" href="#plot-the-qubit-state" title="Permalink to this heading">¶</a></h2>
<p>Below we define a local function that calculates the qubit’s Pauli
expectation values as a function of time (which define also the Bloch
vector),</p>
<div class="math notranslate nohighlight">
\[\langle X(t)\rangle, \langle Y(t)\rangle, \langle Z(t)\rangle.\]</div>
<p>The same function plots both these three curves, and the Bloch vector at
the final time, depicted in 3D on the Bloch sphere. We will reuse this
function in the next section.</p>
<p>We see that for the parameters we have defined, the qubit has completed
almost exactly a <span class="math notranslate nohighlight">\(\pi\)</span>-rotation of the qubit Bloch vector about
the <span class="math notranslate nohighlight">\(x\)</span> axis, from the ground to the excited state (with many
intermediate rotations of its transverse component, whose amplitude
increases and decreases). This mechanism of Rabi oscillations is the
basis for the single-qubit gates used to manipulate quantum devices - in
particular this is a realization of the <span class="math notranslate nohighlight">\(X\)</span> gate.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.visualization</span> <span class="kn">import</span> <span class="n">plot_bloch_vector</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">fontsize</span> <span class="o">=</span> <span class="mi">16</span>

<span class="k">def</span> <span class="nf">plot_qubit_dynamics</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">t_eval</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">):</span>
    <span class="n">n_times</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_times</span><span class="p">,))</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_times</span><span class="p">,))</span>
    <span class="n">z_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_times</span><span class="p">,))</span>

    <span class="k">for</span> <span class="n">t_i</span><span class="p">,</span> <span class="n">sol_t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">):</span>
        <span class="n">x_data</span><span class="p">[</span><span class="n">t_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_t</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
        <span class="n">y_data</span><span class="p">[</span><span class="n">t_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_t</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
        <span class="n">z_data</span><span class="p">[</span><span class="n">t_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sol_t</span><span class="o">.</span><span class="n">expectation_value</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="n">fontsize</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">langle X </span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">langle Y </span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">z_data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">langle Z </span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bloch vector vs. $t$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">fontsize</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">display</span><span class="p">(</span><span class="n">plot_bloch_vector</span><span class="p">([</span><span class="n">x_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">z_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                              <span class="sa">f</span><span class="s1">&#39;Bloch vector at $t = </span><span class="si">{</span><span class="n">t_eval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">))</span>

<span class="n">plot_qubit_dynamics</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">t_eval</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Rabi_oscillations_3_0.png" src="../_images/Rabi_oscillations_3_0.png" />
<img alt="../_images/Rabi_oscillations_3_1.png" src="../_images/Rabi_oscillations_3_1.png" />
</div>
</div>
</section>
<section id="redefine-the-model-with-damping-and-decoherence">
<h2>4. Redefine the model with damping and decoherence<a class="headerlink" href="#redefine-the-model-with-damping-and-decoherence" title="Permalink to this heading">¶</a></h2>
<p>Now we add to our simulation an environment modeled as a memory-less
(Markovian) bath, solving the Lindblad master equation with the same
Hamiltonian as before, but accounting also for energy relaxation and
decoherence terms. We simulate the dynamics to times longer than the
typical relaxation times <span class="math notranslate nohighlight">\(T_1=1/\Gamma_1\)</span> and
<span class="math notranslate nohighlight">\(T_{\phi}=1/\Gamma_2\)</span>. The qubit’s state has to be described using
a density matrix, now evolving according to the Lindblad master
equation,</p>
<div class="math notranslate nohighlight">
\[\partial_t\rho = -\frac{i}{\hbar} \left[H,\rho\right] + \mathcal{D}[\rho].\]</div>
<p>We take the Lindblad dissipator to consist of two terms,</p>
<div class="math notranslate nohighlight">
\[\mathcal{D}[\rho] = \mathcal{D}_1[\rho] + \mathcal{D}_2[\rho].\]</div>
<p>The action of energy relaxation terms describing damping into the
environment with rate <span class="math notranslate nohighlight">\(\Gamma_1\)</span> are generated by</p>
<div class="math notranslate nohighlight">
\[\mathcal{D}_1[\rho] = \Gamma_1\left(\sigma^+ \rho\sigma^- - \frac{1}{2} \{\sigma^- \sigma^+,\rho\}\right),\]</div>
<p>with <span class="math notranslate nohighlight">\(\sigma^{\pm}= \frac{1}{2}\left(X\pm i Y\right)\)</span>.</p>
<p>The second dissipator describes (“pure”) dephasing with rate
<span class="math notranslate nohighlight">\(\Gamma_2\)</span>, and reads</p>
<div class="math notranslate nohighlight">
\[\mathcal{D}_2[\rho] = \Gamma_2\left(Z \rho Z - \rho\right).\]</div>
<p>We use the function defined above for calculating the Bloch vector
components, which can be done since in <code class="docutils literal notranslate"><span class="pre">qiskit</span></code> and in
<code class="docutils literal notranslate"><span class="pre">qiskit-dynamics</span></code> the syntax of many functions is identical for both
state vectors and density matrices. The shrinking of the qubit’s state
within the Bloch sphere due to the incoherent evolution can be clearly
seen in the plots below.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gamma_1</span> <span class="o">=</span> <span class="mf">.8</span>
<span class="n">Gamma_2</span> <span class="o">=</span> <span class="mf">.2</span>

<span class="n">t_final</span> <span class="o">=</span> <span class="mf">5.5</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">Gamma_1</span><span class="p">,</span> <span class="n">Gamma_2</span><span class="p">)</span>

<span class="n">y0</span> <span class="o">=</span> <span class="n">DensityMatrix</span><span class="o">.</span><span class="n">from_label</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span>
    <span class="n">static_hamiltonian</span><span class="o">=</span><span class="mf">.5</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">nu_z</span> <span class="o">*</span> <span class="n">Z</span><span class="p">,</span>
    <span class="n">hamiltonian_operators</span><span class="o">=</span><span class="p">[</span><span class="mf">.5</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">nu_x</span> <span class="o">*</span> <span class="n">X</span><span class="p">],</span>
    <span class="n">static_dissipators</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Gamma_1</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Gamma_2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">n_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">t_final</span> <span class="o">/</span> <span class="n">tau</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">t_final</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>
<span class="n">signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">Signal</span><span class="p">(</span><span class="n">envelope</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">carrier_freq</span><span class="o">=</span><span class="n">nu_d</span><span class="p">)]</span>

<span class="n">sol</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">t_span</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">t_final</span><span class="p">],</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">signals</span><span class="o">=</span><span class="n">signals</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>

<span class="n">plot_qubit_dynamics</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">t_eval</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Rabi_oscillations_4_0.png" src="../_images/Rabi_oscillations_4_0.png" />
<img alt="../_images/Rabi_oscillations_4_1.png" src="../_images/Rabi_oscillations_4_1.png" />
</div>
</div>
</section>
</section>


             </article>
            </div>
            <footer>
<!-- USER FEEDBACK -->
  

    <hr class="helpful-hr hr-top">
      <div class="helpful-container">
        <div class="helpful-question">Was this page helpful?</div>
        <a class="helpful-question yes-link" onclick="clicked('yes')">Yes</a>
        <a class="helpful-question no-link" onclick="clicked('no')">No</a>
        <div class="was-helpful-thank-you" id="was-helpful-thank-you">Thank you!</div>
      </div>
    <hr class="helpful-hr hr-bottom"/>
  
  

  <!-- NEXT/PREVIOUS BUTTONS -->
  <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
    
      <a href="Lindblad_dynamics_simulation.html" class="btn btn-neutral float-right" title="Solving the Lindblad dynamics of a qubit chain" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-purple.svg" class="next-page"></a>
    
    
      <a href="index.html" class="btn btn-neutral" title="Dynamics Tutorials" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-purple.svg" class="previous-page"> Previous</a>
    
  </div>

  <div role="contentinfo">
    <p>
    <!-- SHOW QISKIT COPYRIGHT TEXT -->
        &copy; Copyright 2020, Qiskit Development Team.

    <!-- SHOW DATE PAGE LAST UPDATED -->
      Last updated on 2024/01/16.

    </p>
  </div>

<!-- SHOW 'MADE WITH SPHINX' TEXT -->
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using <a href="https://github.com/Qiskit/qiskit_sphinx_theme">Qiskit Sphinx Theme </a> (based on <a href="https://github.com/pytorch/pytorch_sphinx_theme"> PyTorch Sphinx Theme</a>).
      </div>
     
<br>
</footer>

<script>
  function clicked(ctaType) {
    document.getElementById('was-helpful-thank-you').style.visibility = 'visible';
    window.trackCta(`Helpful - ${ctaType}`);
  }
</script>

          </div>
        </div>

        <!-- RIGHT SIDE AUTOSUMMARY MENU -->
        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Simulating Rabi oscillations with noise and decoherence</a><ul>
<li><a class="reference internal" href="#setup-the-solver-with-the-hamiltonian-model">1. Setup the solver with the Hamiltonian model</a></li>
<li><a class="reference internal" href="#solve-the-system">2. Solve the system</a></li>
<li><a class="reference internal" href="#plot-the-qubit-state">3. Plot the qubit state</a></li>
<li><a class="reference internal" href="#redefine-the-model-with-damping-and-decoherence">4. Redefine the model with damping and decoherence</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div> 

  <!-- MOBILE MENU FOR SIDEBAR -->
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=79807b79"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
      <script src="../_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
    <script type="text/javascript" src="../_static/js/theme.js"></script>

  <!-- enable language dropdown menu expand -->
  <script type="text/javascript">
    jQuery(function () {
        SphinxRtdTheme.Navigation.enable(true);
    });
  </script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>

</body>
</html>